<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Cinematographie | Small Planet Phantasmagoria</title>
  <link rel="stylesheet" href="locstyle.css"> <!-- Link to external CSS file -->
</head>
<body>
  <div class="container">
    <div class="grid">
      <div class="image-row">
        <img src="../images/location/cinema-01.gif">
      </div>
      <div class="text-row">
        <p>
          <span style="font-size: 24px;">Cinematographie</span><br>
          <br>
          Phantasmagoria’s greatest amusement facility. In addition to films, shows Phantas News, which projects happenings from all across the planet. Nextdoor is a bookstore, with a wide array of Mr. Tamura’s books on display en masse. The planet’s greatest pastime—located to the South of the Digital Zone. 
          <br>
          <br>
          Nearby is a bookstore, a full day’s worth of fun for visitors. The Cinematographie not only runs standard showings, but also reports on the day’s events and spreads information pertinent to the coming days in the form of Phantas News. For first-time tourists, the cinema is a must-do, with its news broadcasts serving as a welcome source of intel. At the bookstore, under the constant clamor of the radio, the bookworm of a shopkeeper is manning his shop. While he will be angered by those who stand around browsing his books, those who take care to do so more stealthy will fly under the radar of Mr. Lewes, owner of the store, as he is not as sharp as one might think. Popular volumes can be perused here.
          <br>
        </p>
      </div>
      <div class="navigation">
        <div class="grid-3x3">
          <div></div>
          <a href="digital.html" class="nav-button"><img src="../images/nav-n.webp" alt="Go North"></a>
          <div></div>
          <a href="cheese.html" class="nav-button"><img src="../images/nav-w.webp" alt="Go West"></a>
          <img class="nav-button" id="closepage" src="../images/nav-home.gif" alt="Navigation Home">
          <img class="nav-button" src="../images/nav-h.webp" alt="Stop">
          <div></div>
          <a href="lightbulb.html" class="nav-button"><img src="../images/nav-s.webp" alt="Go South"></a>
          <div></div>
        </div>
      </div>
    </div>
  </div>
  <script>
        window.addEventListener('load', function() {
            document.body.style.opacity = '1';

                // Select all links on the page
                    var links = document.querySelectorAll('a');

                // Loop through each link
                links.forEach(function(link) {
                    // Add click event listener to each link
                    link.addEventListener('click', function(event) {
                        // Prevent the default action to control navigation manually
                        event.preventDefault();
                        
                        // Change body opacity to 0
                        document.body.style.opacity = '0';
                        
                        // Use setTimeout to navigate to the link's href after the opacity change
                        setTimeout(function() {
                            window.location.href = link.href;
                        }, 2000); // Delay should match the transition duration or be slightly longer
                    });
                });
        });
        document.addEventListener('DOMContentLoaded', function() {



      const audioUrl = 'sounds/nav00.m4a'; // Change this to the appropriate audio URL for each iframe page
      const pageTitle = document.title; // Get the current iframe page's title

      // Post message to change the audio in the parent window
      window.top.postMessage({
        action: 'changeAudio',
        url: audioUrl,
        title: pageTitle
      }, '*'); // Ensure that '*' is replaced with the specific origin if security is a concern
    });

    // Add event listener for the close button
    document.getElementById('closepage').addEventListener('click', function() {
      window.parent.postMessage('closeIframe', '*');

      const audioUrl = 'sounds/nav00.m4a'; // Don't change this per loc page
      window.top.postMessage({
        action: 'changeAudio',
        url: audioUrl,
        title: 'Small Planet Phantasmagoria'
      }, '*'); // Ensure that '*' is replaced with the specific origin if security is a concern
    });

    // Function to handle back button and trigger custom actions
    function handleBackNavigation(event) {
      // Prevent the default back navigation
      event.preventDefault();

      // Capture the current scroll position
      const scrollPosition = {
        left: window.scrollX,
        top: window.scrollY
      };

      // Restore the scroll position after navigation
      setTimeout(() => {
        window.scrollTo(scrollPosition.left, scrollPosition.top);
      }, 0);

      window.parent.postMessage('closeIframe', '*');

      const audioUrl = 'sounds/nav00.m4a'; // Don't change this per loc page
      window.top.postMessage({
        action: 'changeAudio',
        url: audioUrl,
        title: 'Small Planet Phantasmagoria'
      }, '*'); // Ensure that '*' is replaced with the specific origin if security is a concern
    }

    // Listen for the popstate event
    window.addEventListener('popstate', function(event) {
      handleBackNavigation(event);
    });

    // Initialize a state to prevent the initial popstate event from being fired
    history.pushState(null, null, window.location.href);
    </script>
</body>
</html>
